<!DOCTYPE html>
<html lang="ru" x-data="app">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI Kit Constructor - SPA</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <style>
        /* CSS переменные (дизайн-токены) */
        :root {
            /* Цветовая палитра - Основные токены */
            --color-primary-50: #eef2ff;
            --color-primary-100: #e0e7ff;
            --color-primary-200: #c7d2fe;
            --color-primary-300: #a5b4fc;
            --color-primary-400: #818cf8;
            --color-primary-500: #6366f1;
            --color-primary-600: #4f46e5;
            --color-primary-700: #4338ca;
            --color-primary-800: #3730a3;
            --color-primary-900: #312e81;
            
            /* Нейтральные цвета */
            --color-gray-50: #f9fafb;
            --color-gray-100: #f3f4f6;
            --color-gray-200: #e5e7eb;
            --color-gray-300: #d1d5db;
            --color-gray-400: #9ca3af;
            --color-gray-500: #6b7280;
            --color-gray-600: #4b5563;
            --color-gray-700: #374151;
            --color-gray-800: #1f2937;
            --color-gray-900: #111827;
            
            /* Семантические цвета */
            --color-success: #10b981;
            --color-warning: #f59e0b;
            --color-error: #ef4444;
            --color-info: #3b82f6;
            
            /* Типографика */
            --font-family-sans: 'Inter', system-ui, -apple-system, sans-serif;
            --font-family-mono: 'Roboto Mono', 'Courier New', monospace;
            
            --font-size-xs: 0.75rem;    /* 12px */
            --font-size-sm: 0.875rem;   /* 14px */
            --font-size-base: 1rem;     /* 16px */
            --font-size-lg: 1.125rem;   /* 18px */
            --font-size-xl: 1.25rem;    /* 20px */
            --font-size-2xl: 1.5rem;    /* 24px */
            --font-size-3xl: 1.875rem;  /* 30px */
            --font-size-4xl: 2.25rem;   /* 36px */
            
            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            
            --line-height-tight: 1.25;
            --line-height-normal: 1.5;
            --line-height-relaxed: 1.75;
            
            /* Отступы */
            --spacing-0: 0;
            --spacing-1: 0.25rem;   /* 4px */
            --spacing-2: 0.5rem;    /* 8px */
            --spacing-3: 0.75rem;   /* 12px */
            --spacing-4: 1rem;      /* 16px */
            --spacing-6: 1.5rem;    /* 24px */
            --spacing-8: 2rem;      /* 32px */
            --spacing-12: 3rem;     /* 48px */
            --spacing-16: 4rem;     /* 64px */
            
            /* Радиусы */
            --radius-sm: 0.25rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-full: 9999px;
            
            /* Тени */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            
            /* Анимации */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Z-индексы */
            --z-dropdown: 10;
            --z-sticky: 20;
            --z-fixed: 30;
            --z-modal: 40;
            --z-popover: 50;
            --z-toast: 60;
        }

        /* Базовые сбросы и стили */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        [x-cloak] {
            display: none !important;
        }

        body {
            font-family: var(--font-family-sans);
            font-size: var(--font-size-base);
            line-height: var(--line-height-normal);
            color: var(--color-gray-800);
            background-color: var(--color-gray-50);
            min-height: 100vh;
        }

        /* Типографика утилиты */
        .h1 { font-size: var(--font-size-4xl); font-weight: var(--font-weight-bold); }
        .h2 { font-size: var(--font-size-3xl); font-weight: var(--font-weight-semibold); }
        .h3 { font-size: var(--font-size-2xl); font-weight: var(--font-weight-semibold); }
        .h4 { font-size: var(--font-size-xl); font-weight: var(--font-weight-medium); }
        .h5 { font-size: var(--font-size-lg); font-weight: var(--font-weight-medium); }
        .h6 { font-size: var(--font-size-base); font-weight: var(--font-weight-medium); }

        .text-xs { font-size: var(--font-size-xs); }
        .text-sm { font-size: var(--font-size-sm); }
        .text-lg { font-size: var(--font-size-lg); }
        .text-xl { font-size: var(--font-size-xl); }

        .text-light { font-weight: var(--font-weight-light); }
        .text-normal { font-weight: var(--font-weight-normal); }
        .text-medium { font-weight: var(--font-weight-medium); }
        .text-semibold { font-weight: var(--font-weight-semibold); }
        .text-bold { font-weight: var(--font-weight-bold); }

        /* Контейнер */
        .container {
            width: 100%;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 var(--spacing-4);
        }

        /* Сетка */
        .grid {
            display: grid;
            gap: var(--spacing-4);
        }

        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }

        /* Flex утилиты */
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: var(--spacing-2); }
        .gap-4 { gap: var(--spacing-4); }

        /* Отступы */
        .p-2 { padding: var(--spacing-2); }
        .p-4 { padding: var(--spacing-4); }
        .p-6 { padding: var(--spacing-6); }
        .px-4 { padding-left: var(--spacing-4); padding-right: var(--spacing-4); }
        .py-2 { padding-top: var(--spacing-2); padding-bottom: var(--spacing-2); }
        .py-4 { padding-top: var(--spacing-4); padding-bottom: var(--spacing-4); }

        .m-2 { margin: var(--spacing-2); }
        .m-4 { margin: var(--spacing-4); }
        .mt-2 { margin-top: var(--spacing-2); }
        .mt-4 { margin-top: var(--spacing-4); }
        .mb-2 { margin-bottom: var(--spacing-2); }
        .mb-4 { margin-bottom: var(--spacing-4); }

        /* Карточка */
        .card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            padding: var(--spacing-6);
            transition: box-shadow var(--transition-normal);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        /* Кнопки */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-2) var(--spacing-4);
            border-radius: var(--radius-md);
            font-weight: var(--font-weight-medium);
            font-size: var(--font-size-sm);
            line-height: var(--line-height-tight);
            border: 1px solid transparent;
            cursor: pointer;
            transition: all var(--transition-normal);
            gap: var(--spacing-2);
        }

        .btn-primary {
            background-color: var(--color-primary-600);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--color-primary-700);
        }

        .btn-secondary {
            background-color: var(--color-gray-200);
            color: var(--color-gray-800);
        }

        .btn-secondary:hover {
            background-color: var(--color-gray-300);
        }

        .btn-outline {
            background-color: transparent;
            border-color: var(--color-gray-300);
            color: var(--color-gray-700);
        }

        .btn-outline:hover {
            background-color: var(--color-gray-50);
        }

        /* Формы */
        .form-group {
            margin-bottom: var(--spacing-4);
        }

        .form-label {
            display: block;
            margin-bottom: var(--spacing-1);
            font-weight: var(--font-weight-medium);
            color: var(--color-gray-700);
            font-size: var(--font-size-sm);
        }

        .form-input {
            width: 100%;
            padding: var(--spacing-2) var(--spacing-3);
            border: 1px solid var(--color-gray-300);
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: var(--font-size-sm);
            transition: border-color var(--transition-normal);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--color-primary-500);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* Навигация */
        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            padding: var(--spacing-2) var(--spacing-4);
            color: var(--color-gray-600);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: all var(--transition-normal);
        }

        .nav-link:hover {
            background-color: var(--color-gray-100);
            color: var(--color-gray-900);
        }

        .nav-link.active {
            background-color: var(--color-primary-50);
            color: var(--color-primary-700);
            font-weight: var(--font-weight-medium);
        }

        /* Badge */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: var(--spacing-1) var(--spacing-2);
            border-radius: var(--radius-full);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-medium);
        }

        .badge-primary {
            background-color: var(--color-primary-100);
            color: var(--color-primary-800);
        }

        .badge-success {
            background-color: #d1fae5;
            color: #065f46;
        }

        .badge-warning {
            background-color: #fef3c7;
            color: #92400e;
        }

        .badge-error {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .badge-info {
            background-color: #dbeafe;
            color: #1e40af;
        }

        /* Анимации */
        .fade-enter-active, .fade-leave-active {
            transition: opacity var(--transition-normal);
        }

        .fade-enter, .fade-leave-to {
            opacity: 0;
        }

        /* Адаптивность */
        @media (max-width: 768px) {
            .container {
                padding: 0 var(--spacing-2);
            }
            
            .grid-cols-2,
            .grid-cols-3,
            .grid-cols-4 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }
        }
    </style>
</head>
<body x-data="{ mobileMenuOpen: false }">
    <!-- Навигация -->
    <nav class="bg-white shadow-md py-3">
        <div class="container flex items-center justify-between">
            <!-- Логотип и бренд -->
            <div class="flex items-center gap-4">
                <button @click="mobileMenuOpen = !mobileMenuOpen" class="md:hidden p-2">
                    <i class="fas fa-bars text-gray-600"></i>
                </button>
                
                <div class="flex items-center gap-2">
                    <i class="fas fa-palette text-primary-600 text-xl"></i>
                    <h1 class="h5 font-semibold">UI Kit Constructor</h1>
                    <span class="badge badge-primary text-xs">v1.0.0</span>
                </div>
            </div>
            
            <!-- Навигация для десктопа -->
            <div class="hidden md:flex items-center gap-1">
                <a href="#" @click.prevent="$store.app.currentView = 'dashboard'" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'dashboard' }">
                    <i class="fas fa-home"></i> Дашборд
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'editor'" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'editor' }">
                    <i class="fas fa-edit"></i> Редактор
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'library'" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'library' }">
                    <i class="fas fa-boxes"></i> Библиотека
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'tokens'" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'tokens' }">
                    <i class="fas fa-swatchbook"></i> Токены
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'versions'" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'versions' }">
                    <i class="fas fa-code-branch"></i> Версии
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'collaboration'" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'collaboration' }">
                    <i class="fas fa-users"></i> Коллаборация
                </a>
                
                <!-- Дополнительные действия -->
                <div class="relative" x-data="{ dropdownOpen: false }">
                    <button @click="dropdownOpen = !dropdownOpen" 
                            class="nav-link">
                        <i class="fas fa-cog"></i> Действия
                    </button>
                    
                    <div x-show="dropdownOpen" 
                         @click.outside="dropdownOpen = false"
                         class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border py-2 z-10">
                        <a href="#" @click.prevent="generateCSSFile(); dropdownOpen = false" 
                           class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-file-code mr-2"></i> Генерировать CSS
                        </a>
                        <a href="#" @click.prevent="exportFullSystem(); dropdownOpen = false" 
                           class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                            <i class="fas fa-download mr-2"></i> Экспорт системы
                        </a>
                        <label class="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">
                            <i class="fas fa-upload mr-2"></i> Импорт системы
                            <input type="file" @change="importSystem" class="hidden" accept=".json">
                        </label>
                        <div class="border-t my-2"></div>
                        <a href="#" @click.prevent="clearAllData(); dropdownOpen = false" 
                           class="block px-4 py-2 text-error-600 hover:bg-error-50">
                            <i class="fas fa-trash mr-2"></i> Очистить все данные
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Действия пользователя -->
            <div class="flex items-center gap-3">
                <button class="btn btn-outline">
                    <i class="fas fa-download"></i> Экспорт
                </button>
                <div class="relative">
                    <button class="flex items-center gap-2 p-2 rounded-lg hover:bg-gray-100">
                        <div class="w-8 h-8 rounded-full bg-primary-500 flex items-center justify-center text-white">
                            <i class="fas fa-user"></i>
                        </div>
                        <span class="hidden md:inline">Профиль</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Мобильное меню -->
        <div x-show="mobileMenuOpen" class="md:hidden border-t mt-3 py-3">
            <div class="container flex flex-col gap-2">
                <a href="#" @click.prevent="$store.app.currentView = 'dashboard'; mobileMenuOpen = false" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'dashboard' }">
                    <i class="fas fa-home"></i> Дашборд
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'editor'; mobileMenuOpen = false" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'editor' }">
                    <i class="fas fa-edit"></i> Редактор
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'library'; mobileMenuOpen = false" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'library' }">
                    <i class="fas fa-boxes"></i> Библиотека
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'tokens'; mobileMenuOpen = false" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'tokens' }">
                    <i class="fas fa-swatchbook"></i> Токены
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'versions'; mobileMenuOpen = false" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'versions' }">
                    <i class="fas fa-code-branch"></i> Версии
                </a>
                <a href="#" @click.prevent="$store.app.currentView = 'collaboration'; mobileMenuOpen = false" 
                   class="nav-link" :class="{ 'active': $store.app.currentView === 'collaboration' }">
                    <i class="fas fa-users"></i> Коллаборация
                </a>
            </div>
        </div>
    </nav>
    
    <main class="py-6">
        <div class="container">
            <!-- Дашборд -->
            <div x-show="$store.app.currentView === 'dashboard'" x-cloak>
                <div class="mb-6">
                    <h2 class="h2 mb-2">Дашборд конструктора UI Kit</h2>
                    <p class="text-gray-600">Создавайте, управляйте и экспортируйте компоненты дизайн-системы</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="h5">Статистика</h3>
                            <i class="fas fa-chart-bar text-primary-500"></i>
                        </div>
                        <div class="space-y-3">
                            <div>
                                <p class="text-sm text-gray-500">Всего компонентов</p>
                                <p class="text-2xl font-bold" x-text="$store.components ? $store.components.list.length : 0">0</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">Последнее обновление</p>
                                <p class="text-lg" x-text="new Date().toLocaleDateString('ru-RU')"></p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="h5">Быстрые действия</h3>
                            <i class="fas fa-bolt text-warning-500"></i>
                        </div>
                        <div class="space-y-2">
                            <button @click="$store.app.currentView = 'editor'" class="w-full btn btn-outline justify-start">
                                <i class="fas fa-plus"></i> Создать компонент
                            </button>
                            <button @click="$store.app.currentView = 'tokens'" class="w-full btn btn-outline justify-start">
                                <i class="fas fa-palette"></i> Настроить токены
                            </button>
                            <button @click="exportAll()" class="w-full btn btn-outline justify-start">
                                <i class="fas fa-download"></i> Экспортировать все
                            </button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="h5">Активность</h3>
                            <i class="fas fa-history text-info-500"></i>
                        </div>
                        <div class="space-y-2">
                            <div class="text-sm">
                                <p class="font-medium">Нет недавней активности</p>
                                <p class="text-gray-500">Начните создавать компоненты</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Редактор компонентов -->
            <div x-show="$store.app.currentView === 'editor'" x-cloak x-data="editor">
                <div class="mb-6">
                    <h2 class="h2 mb-2">Редактор компонентов</h2>
                    <p class="text-gray-600">Создавайте и редактируйте компоненты вашей дизайн-системы</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Панель создания -->
                    <div class="card lg:col-span-1">
                        <h3 class="h5 mb-4">Создать компонент</h3>
                        
                        <div class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">Тип компонента</label>
                                <select x-model="newComponentType" class="form-input">
                                    <option value="">Выберите тип</option>
                                    <template x-for="type in $store.components.componentTypes" :key="type">
                                        <option :value="type" x-text="type.charAt(0).toUpperCase() + type.slice(1)"></option>
                                    </template>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Название компонента</label>
                                <input type="text" x-model="newComponentName" class="form-input" placeholder="Например, Основная кнопка">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Категория</label>
                                <select x-model="newComponentCategory" class="form-input">
                                    <option value="basic">Базовые</option>
                                    <option value="forms">Формы</option>
                                    <option value="layout">Макет</option>
                                    <option value="feedback">Обратная связь</option>
                                    <option value="navigation">Навигация</option>
                                </select>
                            </div>
                            
                            <button @click="createNewComponent()" 
                                    class="w-full btn btn-primary"
                                    :disabled="!newComponentType">
                                <i class="fas fa-plus"></i> Создать компонент
                            </button>
                        </div>
                        
                        <!-- Список компонентов -->
                        <div class="mt-6">
                            <h4 class="h6 mb-3">Мои компоненты</h4>
                            <div class="space-y-2 max-h-60 overflow-y-auto">
                                <template x-for="component in $store.components.list" :key="component.id">
                                    <div @click="$store.components.currentComponent = component"
                                         class="p-3 rounded-lg border cursor-pointer hover:border-primary-300 transition-colors"
                                         :class="{ 'border-primary-500 bg-primary-50': $store.components.currentComponent?.id === component.id }">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="font-medium" x-text="component.name"></p>
                                                <p class="text-xs text-gray-500" x-text="component.type"></p>
                                            </div>
                                            <span class="badge badge-primary" x-text="component.version"></span>
                                        </div>
                                    </div>
                                </template>
                                
                                <div x-show="$store.components.list.length === 0" class="text-center py-4 text-gray-500">
                                    <i class="fas fa-inbox text-2xl mb-2"></i>
                                    <p>Нет созданных компонентов</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Редактор -->
                    <div class="card lg:col-span-2" x-show="$store.components.currentComponent">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <h3 class="h4" x-text="$store.components.currentComponent?.name"></h3>
                                <p class="text-sm text-gray-500" x-text="`Тип: ${$store.components.currentComponent?.type}`"></p>
                            </div>
                            
                            <div class="flex gap-2">
                                <button @click="saveComponent()" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Сохранить
                                </button>
                                <button @click="exportComponent($store.components.currentComponent)" class="btn btn-outline">
                                    <i class="fas fa-download"></i> Экспорт
                                </button>
                            </div>
                        </div>
                        
                        <!-- Вкладки редактора -->
                        <div class="border-b mb-4">
                            <div class="flex space-x-4">
                                <button @click="editorTab = 'preview'" 
                                        class="pb-2 px-1 border-b-2 font-medium"
                                        :class="editorTab === 'preview' ? 'border-primary-500 text-primary-700' : 'border-transparent text-gray-500'">
                                    <i class="fas fa-eye mr-2"></i> Предпросмотр
                                </button>
                                <button @click="editorTab = 'properties'" 
                                        class="pb-2 px-1 border-b-2 font-medium"
                                        :class="editorTab === 'properties' ? 'border-primary-500 text-primary-700' : 'border-transparent text-gray-500'">
                                    <i class="fas fa-sliders-h mr-2"></i> Свойства
                                </button>
                                <button @click="editorTab = 'code'" 
                                        class="pb-2 px-1 border-b-2 font-medium"
                                        :class="editorTab === 'code' ? 'border-primary-500 text-primary-700' : 'border-transparent text-gray-500'">
                                    <i class="fas fa-code mr-2"></i> Код
                                </button>
                                <button @click="editorTab = 'variants'" 
                                        class="pb-2 px-1 border-b-2 font-medium"
                                        :class="editorTab === 'variants' ? 'border-primary-500 text-primary-700' : 'border-transparent text-gray-500'">
                                    <i class="fas fa-layer-group mr-2"></i> Варианты
                                </button>
                            </div>
                        </div>
                        
                        <!-- Контент вкладок -->
                        <div x-show="editorTab === 'preview'">
                            <div class="p-6 border rounded-lg bg-gray-50 mb-4">
                                <h4 class="h6 mb-3">Предпросмотр компонента</h4>
                                
                                <!-- Динамический превью компонента -->
                                <div id="componentPreview" class="p-4 bg-white rounded border">
                                    <template x-if="$store.components.currentComponent?.type === 'button'">
                                        <button :style="{
                                            backgroundColor: $store.components.currentComponent?.variants[0]?.properties?.bgColor,
                                            color: $store.components.currentComponent?.variants[0]?.properties?.textColor,
                                            padding: $store.components.currentComponent?.variants[0]?.properties?.padding,
                                            borderRadius: $store.components.currentComponent?.variants[0]?.properties?.borderRadius,
                                            fontSize: $store.components.currentComponent?.variants[0]?.properties?.fontSize,
                                            fontWeight: $store.components.currentComponent?.variants[0]?.properties?.fontWeight,
                                            border: 'none',
                                            cursor: 'pointer'
                                        }" x-text="$store.components.currentComponent?.variants[0]?.properties?.text || 'Кнопка'">
                                        </button>
                                    </template>
                                    
                                    <template x-if="$store.components.currentComponent?.type === 'card'">
                                        <div :style="{
                                            backgroundColor: $store.components.currentComponent?.variants[0]?.properties?.bgColor,
                                            padding: $store.components.currentComponent?.variants[0]?.properties?.padding,
                                            borderRadius: $store.components.currentComponent?.variants[0]?.properties?.borderRadius,
                                            boxShadow: $store.components.currentComponent?.variants[0]?.properties?.shadow
                                        }">
                                            <h4 class="font-bold mb-2">Заголовок карточки</h4>
                                            <p class="text-gray-600">Пример содержимого карточки. Здесь может быть любой текст или другие компоненты.</p>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                        
                        <div x-show="editorTab === 'properties'">
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">Название компонента</label>
                                    <input type="text" x-model="$store.components.currentComponent.name" 
                                           @change="$store.components.updateComponent($store.components.currentComponent.id, { name: $event.target.value })"
                                           class="form-input">
                                </div>
                                
                                <template x-if="$store.components.currentComponent?.type === 'button'">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="form-group">
                                            <label class="form-label">Текст кнопки</label>
                                            <input type="text" x-model="$store.components.currentComponent.variants[0].properties.text"
                                                   class="form-input">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Цвет фона</label>
                                            <input type="color" x-model="$store.components.currentComponent.variants[0].properties.bgColor"
                                                   class="form-input p-1 h-10">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Цвет текста</label>
                                            <input type="color" x-model="$store.components.currentComponent.variants[0].properties.textColor"
                                                   class="form-input p-1 h-10">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Скругление</label>
                                            <select x-model="$store.components.currentComponent.variants[0].properties.borderRadius" class="form-input">
                                                <option value="0">Без скругления</option>
                                                <option value="var(--radius-sm)">Маленькое</option>
                                                <option value="var(--radius-md)">Среднее</option>
                                                <option value="var(--radius-lg)">Большое</option>
                                                <option value="var(--radius-full)">Полное</option>
                                            </select>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                        
                        <div x-show="editorTab === 'code'" class="space-y-4">
                            <div>
                                <label class="form-label">HTML</label>
                                <textarea class="form-input font-mono text-sm h-32" 
                                          x-model="$store.components.currentComponent.variants[0].html"
                                          placeholder="HTML код компонента"></textarea>
                            </div>
                            
                            <div>
                                <label class="form-label">CSS</label>
                                <textarea class="form-input font-mono text-sm h-32"
                                          x-model="$store.components.currentComponent.variants[0].css"
                                          placeholder="CSS стили компонента"></textarea>
                            </div>
                        </div>
                        
                        <div x-show="editorTab === 'variants'">
                            <div class="flex items-center justify-between mb-4">
                                <h4 class="h6">Варианты компонента</h4>
                                <button @click="addVariant()" class="btn btn-outline btn-sm">
                                    <i class="fas fa-plus"></i> Добавить вариант
                                </button>
                            </div>
                            
                            <div class="space-y-3">
                                <template x-for="(variant, index) in $store.components.currentComponent?.variants" :key="index">
                                    <div class="p-3 border rounded-lg">
                                        <div class="flex items-center justify-between mb-2">
                                            <div class="flex items-center gap-2">
                                                <span class="font-medium" x-text="variant.name"></span>
                                                <span x-show="index === 0" class="badge badge-success text-xs">По умолчанию</span>
                                            </div>
                                            
                                            <div class="flex gap-2">
                                                <button @click="editVariant(index)" class="text-gray-500 hover:text-primary-600">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <button x-show="index > 0" @click="removeVariant(index)" class="text-gray-500 hover:text-error-600">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div class="text-sm text-gray-500">
                                            <p>Свойств: <span x-text="Object.keys(variant.properties || {}).length"></span></p>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Пустое состояние редактора -->
                    <div x-show="!$store.components.currentComponent" class="lg:col-span-2 card flex items-center justify-center py-12">
                        <div class="text-center">
                            <i class="fas fa-magic text-4xl text-gray-300 mb-4"></i>
                            <h3 class="h5 mb-2">Выберите компонент</h3>
                            <p class="text-gray-500 mb-4">Выберите существующий компонент или создайте новый</p>
                            <button @click="$store.app.currentView = 'dashboard'" class="btn btn-primary">
                                <i class="fas fa-arrow-left mr-2"></i> Вернуться на дашборд
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Библиотека компонентов -->
            <div x-show="$store.app.currentView === 'library'" x-cloak x-data="library">
                <div class="mb-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 class="h2 mb-2">Библиотека компонентов</h2>
                            <p class="text-gray-600">Все созданные компоненты вашей дизайн-системы</p>
                        </div>
                        
                        <div class="flex gap-2">
                            <button @click="exportLibrary()" class="btn btn-outline">
                                <i class="fas fa-download"></i> Экспорт библиотеки
                            </button>
                            <button @click="$store.app.currentView = 'editor'" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Новый компонент
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Фильтры и поиск -->
                <div class="card mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="form-label">Поиск</label>
                            <div class="relative">
                                <input type="text" 
                                       x-model="searchQuery"
                                       placeholder="Название или тип..."
                                       class="form-input pl-10">
                                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div>
                            <label class="form-label">Тип компонента</label>
                            <select x-model="filterType" class="form-input">
                                <option value="">Все типы</option>
                                <template x-for="type in $store.components.componentTypes" :key="type">
                                    <option :value="type" x-text="type.charAt(0).toUpperCase() + type.slice(1)"></option>
                                </template>
                            </select>
                        </div>
                        
                        <div>
                            <label class="form-label">Категория</label>
                            <select x-model="filterCategory" class="form-input">
                                <option value="">Все категории</option>
                                <option value="basic">Базовые</option>
                                <option value="forms">Формы</option>
                                <option value="layout">Макет</option>
                                <option value="feedback">Обратная связь</option>
                                <option value="navigation">Навигация</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="form-label">Сортировка</label>
                            <select x-model="sortBy" class="form-input">
                                <option value="name">По названию</option>
                                <option value="createdAt">По дате создания</option>
                                <option value="updatedAt">По дате обновления</option>
                                <option value="type">По типу</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Список компонентов -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <template x-for="component in filteredComponents" :key="component.id">
                        <div class="card group hover:shadow-lg transition-shadow">
                            <div class="flex items-start justify-between mb-4">
                                <div>
                                    <h3 class="h5 mb-1" x-text="component.name"></h3>
                                    <div class="flex items-center gap-2">
                                        <span class="badge badge-primary" x-text="component.type"></span>
                                        <span class="badge" 
                                              :class="{
                                                  'badge-primary': component.category === 'basic',
                                                  'badge-success': component.category === 'forms',
                                                  'badge-warning': component.category === 'layout',
                                                  'badge-info': component.category === 'feedback'
                                              }"
                                              x-text="getCategoryName(component.category)"></span>
                                    </div>
                                </div>
                                
                                <div class="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                    <button @click="editComponent(component)" 
                                            class="p-1 text-gray-500 hover:text-primary-600">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button @click="exportComponent(component)"
                                            class="p-1 text-gray-500 hover:text-primary-600">
                                        <i class="fas fa-download"></i>
                                    </button>
                                    <button @click="deleteComponent(component)"
                                            class="p-1 text-gray-500 hover:text-error-600">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Превью компонента -->
                            <div class="mb-4 p-4 border rounded-lg bg-gray-50">
                                <template x-if="component.type === 'button'">
                                    <button class="btn" 
                                            :style="{
                                                backgroundColor: component.variants[0]?.properties?.bgColor || 'var(--color-primary-600)',
                                                color: component.variants[0]?.properties?.textColor || 'white',
                                                padding: component.variants[0]?.properties?.padding || 'var(--spacing-2) var(--spacing-4)'
                                            }"
                                            x-text="component.variants[0]?.properties?.text || 'Кнопка'">
                                    </button>
                                </template>
                                
                                <template x-if="component.type === 'card'">
                                    <div class="p-4 bg-white rounded-lg shadow"
                                         :style="{
                                             padding: component.variants[0]?.properties?.padding || 'var(--spacing-4)'
                                         }">
                                        <div class="font-medium mb-2">Пример карточки</div>
                                        <div class="text-sm text-gray-600">Компонент типа: <span x-text="component.type"></span></div>
                                    </div>
                                </template>
                                
                                <template x-if="!['button', 'card'].includes(component.type)">
                                    <div class="text-center py-4 text-gray-400">
                                        <i class="fas fa-cube text-2xl mb-2"></i>
                                        <p class="text-sm">Предпросмотр для <span x-text="component.type"></span></p>
                                    </div>
                                </template>
                            </div>
                            
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <div>
                                    <i class="fas fa-layer-group mr-1"></i>
                                    <span x-text="component.variants?.length || 0"></span> вариантов
                                </div>
                                
                                <div>
                                    <i class="fas fa-clock mr-1"></i>
                                    <span x-text="formatDate(component.updatedAt)"></span>
                                </div>
                            </div>
                            
                            <div class="mt-4 pt-4 border-t">
                                <button @click="editComponent(component)" 
                                        class="w-full btn btn-outline justify-center">
                                    <i class="fas fa-edit mr-2"></i> Редактировать
                                </button>
                            </div>
                        </div>
                    </template>
                    
                    <!-- Пустое состояние -->
                    <div x-show="filteredComponents.length === 0" class="md:col-span-2 lg:col-span-3">
                        <div class="card text-center py-12">
                            <i class="fas fa-box-open text-4xl text-gray-300 mb-4"></i>
                            <h3 class="h5 mb-2">Библиотека пуста</h3>
                            <p class="text-gray-500 mb-4" x-text="searchQuery || filterType || filterCategory ? 
                                'Нет компонентов, соответствующих фильтрам' : 
                                'Создайте первый компонент, чтобы начать работу'"></p>
                            <button @click="$store.app.currentView = 'editor'" class="btn btn-primary">
                                <i class="fas fa-plus mr-2"></i> Создать компонент
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Пагинация -->
                <div x-show="filteredComponents.length > 0" class="mt-8 flex items-center justify-between">
                    <div class="text-sm text-gray-500">
                        Показано <span x-text="filteredComponents.length"></span> из 
                        <span x-text="$store.components.list.length"></span> компонентов
                    </div>
                    
                    <div class="flex gap-2">
                        <button class="btn btn-outline" :disabled="currentPage === 1" @click="currentPage--">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="px-4 py-2">Страница <span x-text="currentPage"></span></span>
                        <button class="btn btn-outline" @click="currentPage++">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Дизайн-токены -->
            <div x-show="$store.app.currentView === 'tokens'" x-cloak>
                <div class="mb-6">
                    <h2 class="h2 mb-2">Дизайн-токены</h2>
                    <p class="text-gray-600">Управление цветами, типографикой и другими переменными дизайн-системы</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card">
                        <h3 class="h5 mb-4">Цветовая палитра</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <h4 class="h6 mb-2 text-primary-700">Основные цвета</h4>
                                <div class="grid grid-cols-5 gap-2">
                                    <template x-for="shade in ['50', '100', '200', '300', '400', '500', '600', '700', '800', '900']" :key="shade">
                                        <div class="text-center">
                                            <div class="w-full h-12 rounded mb-1 border" 
                                                 :style="{backgroundColor: `var(--color-primary-${shade})`}"></div>
                                            <span class="text-xs" x-text="shade"></span>
                                        </div>
                                    </template>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="h6 mb-2 text-gray-700">Нейтральные цвета</h4>
                                <div class="grid grid-cols-5 gap-2">
                                    <template x-for="shade in ['50', '100', '200', '300', '400', '500', '600', '700', '800', '900']" :key="shade">
                                        <div class="text-center">
                                            <div class="w-full h-12 rounded mb-1 border" 
                                                 :style="{backgroundColor: `var(--color-gray-${shade})`}"></div>
                                            <span class="text-xs" x-text="shade"></span>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 class="h5 mb-4">Типографика</h3>
                        
                        <div class="space-y-4">
                            <div>
                                <h4 class="h6 mb-2">Размеры шрифтов</h4>
                                <div class="space-y-3">
                                    <template x-for="size in ['xs', 'sm', 'base', 'lg', 'xl', '2xl', '3xl', '4xl']" :key="size">
                                        <div>
                                            <div class="flex justify-between text-sm text-gray-600">
                                                <span x-text="`--font-size-${size}`"></span>
                                                <span x-text="`var(--font-size-${size})`"></span>
                                            </div>
                                            <p :style="{fontSize: `var(--font-size-${size})`}" 
                                               x-text="`Пример текста размером ${size}`"></p>
                                        </div>
                                    </template>
                                </div>
                            </div>
                            
                            <div>
                                <h4 class="h6 mb-2">Насыщенность шрифтов</h4>
                                <div class="space-y-2">
                                    <template x-for="weight in ['light', 'normal', 'medium', 'semibold', 'bold']" :key="weight">
                                        <p :style="{fontWeight: `var(--font-weight-${weight})`}" 
                                           x-text="`Текст с насыщенностью ${weight}`"></p>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Управление версиями -->
            <div x-show="$store.app.currentView === 'versions'" x-cloak x-data="versions">
                <div class="mb-6">
                    <h2 class="h2 mb-2">Управление версиями</h2>
                    <p class="text-gray-600">История изменений и контроль версий компонентов</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Панель создания версий -->
                    <div class="card lg:col-span-1">
                        <h3 class="h5 mb-4">Создать релиз</h3>
                        
                        <div class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">Версия релиза</label>
                                <div class="flex gap-2">
                                    <input type="number" x-model="newVersion.major" min="0" 
                                           class="form-input text-center" placeholder="1">
                                    <span class="self-center text-gray-500">.</span>
                                    <input type="number" x-model="newVersion.minor" min="0" 
                                           class="form-input text-center" placeholder="0">
                                    <span class="self-center text-gray-500">.</span>
                                    <input type="number" x-model="newVersion.patch" min="0" 
                                           class="form-input text-center" placeholder="0">
                                </div>
                                <p class="text-xs text-gray-500 mt-1">
                                    Текущая версия: <span x-text="getCurrentVersion()"></span>
                                </p>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Тип изменений</label>
                                <select x-model="newVersion.changeType" class="form-input">
                                    <option value="major">Major - критические изменения</option>
                                    <option value="minor">Minor - новые функции</option>
                                    <option value="patch">Patch - исправления ошибок</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Описание изменений</label>
                                <textarea x-model="newVersion.description" 
                                          class="form-input h-32"
                                          placeholder="Опишите изменения в этой версии..."></textarea>
                            </div>
                            
                            <button @click="createRelease()" 
                                    class="w-full btn btn-primary"
                                    :disabled="!isValidVersion()">
                                <i class="fas fa-tag"></i> Создать релиз
                            </button>
                        </div>
                        
                        <!-- Статистика версий -->
                        <div class="mt-6 pt-6 border-t">
                            <h4 class="h6 mb-3">Статистика</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Всего релизов</span>
                                    <span class="font-medium" x-text="releases.length"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Последний релиз</span>
                                    <span class="font-medium" x-text="releases[0]?.version || 'Нет'"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Измененных компонентов</span>
                                    <span class="font-medium" x-text="getChangedComponentsCount()"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- История версий -->
                    <div class="card lg:col-span-2">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="h5">История релизов</h3>
                            
                            <div class="flex gap-2">
                                <button @click="exportVersionHistory()" class="btn btn-outline">
                                    <i class="fas fa-download"></i> Экспорт истории
                                </button>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <template x-for="release in releases" :key="release.id">
                                <div class="p-4 border rounded-lg hover:border-primary-300 transition-colors">
                                    <div class="flex items-start justify-between mb-3">
                                        <div>
                                            <div class="flex items-center gap-2 mb-1">
                                                <span class="font-semibold text-lg" x-text="release.version"></span>
                                                <span class="badge" 
                                                      :class="{
                                                          'badge-error': release.changeType === 'major',
                                                          'badge-warning': release.changeType === 'minor',
                                                          'badge-success': release.changeType === 'patch'
                                                      }"
                                                      x-text="getChangeTypeName(release.changeType)"></span>
                                            </div>
                                            <p class="text-sm text-gray-500" x-text="formatDate(release.createdAt)"></p>
                                        </div>
                                        
                                        <div class="flex gap-2">
                                            <button @click="viewReleaseDetails(release)" 
                                                    class="text-gray-500 hover:text-primary-600">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button @click="exportRelease(release)"
                                                    class="text-gray-500 hover:text-primary-600">
                                                <i class="fas fa-download"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <p class="text-gray-700 mb-3" x-text="release.description"></p>
                                    
                                    <div class="text-sm">
                                        <div class="flex items-center gap-2 text-gray-500">
                                            <i class="fas fa-cube"></i>
                                            <span x-text="release.components?.length || 0"></span> компонентов
                                        </div>
                                    </div>
                                    
                                    <!-- Детали релиза (скрыты по умолчанию) -->
                                    <div x-show="selectedReleaseId === release.id" class="mt-4 pt-4 border-t">
                                        <h5 class="font-medium mb-2">Измененные компоненты:</h5>
                                        <div class="space-y-2">
                                            <template x-for="component in release.components || []" :key="component.id">
                                                <div class="p-2 bg-gray-50 rounded text-sm">
                                                    <div class="flex items-center justify-between">
                                                        <span class="font-medium" x-text="component.name"></span>
                                                        <span class="text-gray-500" x-text="component.version"></span>
                                                    </div>
                                                    <div class="text-gray-500 mt-1" x-text="component.changes || 'Изменения не указаны'"></div>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </div>
                            </template>
                            
                            <!-- Пустое состояние -->
                            <div x-show="releases.length === 0" class="text-center py-8">
                                <i class="fas fa-history text-3xl text-gray-300 mb-3"></i>
                                <h4 class="h6 mb-2">Нет созданных релизов</h4>
                                <p class="text-gray-500">Создайте первый релиз вашей дизайн-системы</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Коллаборация -->
            <div x-show="$store.app.currentView === 'collaboration'" x-cloak x-data="collaboration">
                <div class="mb-6">
                    <h2 class="h2 mb-2">Коллаборация</h2>
                    <p class="text-gray-600">Комментарии, обратная связь и совместная работа</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Форма обратной связи -->
                    <div class="card lg:col-span-1">
                        <h3 class="h5 mb-4">Оставить отзыв</h3>
                        
                        <div class="space-y-4">
                            <div class="form-group">
                                <label class="form-label">Компонент</label>
                                <select x-model="newFeedback.componentId" class="form-input">
                                    <option value="">Выберите компонент</option>
                                    <template x-for="component in $store.components.list" :key="component.id">
                                        <option :value="component.id" x-text="component.name"></option>
                                    </template>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Тип отзыва</label>
                                <select x-model="newFeedback.type" class="form-input">
                                    <option value="comment">Комментарий</option>
                                    <option value="suggestion">Предложение</option>
                                    <option value="issue">Проблема</option>
                                    <option value="praise">Похвала</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Сообщение</label>
                                <textarea x-model="newFeedback.message" 
                                          class="form-input h-32"
                                          placeholder="Ваш отзыв или предложение..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Приоритет</label>
                                <div class="flex gap-2">
                                    <button @click="newFeedback.priority = 'low'" 
                                            class="flex-1 btn" 
                                            :class="newFeedback.priority === 'low' ? 'btn-primary' : 'btn-outline'">
                                        Низкий
                                    </button>
                                    <button @click="newFeedback.priority = 'medium'" 
                                            class="flex-1 btn" 
                                            :class="newFeedback.priority === 'medium' ? 'btn-primary' : 'btn-outline'">
                                        Средний
                                    </button>
                                    <button @click="newFeedback.priority = 'high'" 
                                            class="flex-1 btn" 
                                            :class="newFeedback.priority === 'high' ? 'btn-primary' : 'btn-outline'">
                                        Высокий
                                    </button>
                                </div>
                            </div>
                            
                            <button @click="submitFeedback()" 
                                    class="w-full btn btn-primary"
                                    :disabled="!isValidFeedback()">
                                <i class="fas fa-paper-plane"></i> Отправить отзыв
                            </button>
                        </div>
                        
                        <!-- Статистика отзывов -->
                        <div class="mt-6 pt-6 border-t">
                            <h4 class="h6 mb-3">Статистика</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Всего отзывов</span>
                                    <span class="font-medium" x-text="feedbacks.length"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Открытых проблем</span>
                                    <span class="font-medium" x-text="getOpenIssuesCount()"></span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Решенных</span>
                                    <span class="font-medium" x-text="getResolvedCount()"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Лента отзывов -->
                    <div class="card lg:col-span-2">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="h5">Лента отзывов</h3>
                            
                            <div class="flex gap-2">
                                <select x-model="feedbackFilter" class="form-input py-1 text-sm">
                                    <option value="all">Все отзывы</option>
                                    <option value="open">Только открытые</option>
                                    <option value="resolved">Только решенные</option>
                                    <option value="issues">Только проблемы</option>
                                    <option value="suggestions">Только предложения</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <template x-for="feedback in filteredFeedbacks" :key="feedback.id">
                                <div class="p-4 border rounded-lg" 
                                     :class="{
                                         'border-error-200 bg-error-50': feedback.type === 'issue',
                                         'border-warning-200 bg-warning-50': feedback.type === 'suggestion',
                                         'border-success-200 bg-success-50': feedback.resolved,
                                         'border-gray-200': !feedback.resolved && feedback.type === 'comment'
                                     }">
                                    <div class="flex items-start justify-between mb-3">
                                        <div>
                                            <div class="flex items-center gap-2 mb-1">
                                                <span class="font-semibold" 
                                                      x-text="getComponentName(feedback.componentId)"></span>
                                                
                                                <span class="badge" 
                                                      :class="{
                                                          'badge-error': feedback.type === 'issue',
                                                          'badge-warning': feedback.type === 'suggestion',
                                                          'badge-info': feedback.type === 'comment',
                                                          'badge-success': feedback.type === 'praise'
                                                      }"
                                                      x-text="getFeedbackTypeName(feedback.type)"></span>
                                                
                                                <span class="badge" 
                                                      :class="{
                                                          'badge-success': feedback.priority === 'low',
                                                          'badge-warning': feedback.priority === 'medium',
                                                          'badge-error': feedback.priority === 'high'
                                                      }"
                                                      x-text="getPriorityName(feedback.priority)"></span>
                                                
                                                <span x-show="feedback.resolved" class="badge badge-success">
                                                    <i class="fas fa-check mr-1"></i> Решено
                                                </span>
                                            </div>
                                            
                                            <p class="text-sm text-gray-500">
                                                <span x-text="formatDate(feedback.createdAt)"></span>
                                                <span x-show="feedback.author"> • Автор: <span x-text="feedback.author"></span></span>
                                            </p>
                                        </div>
                                        
                                        <div class="flex gap-2">
                                            <button x-show="!feedback.resolved" 
                                                    @click="resolveFeedback(feedback)"
                                                    class="text-gray-500 hover:text-success-600"
                                                    title="Пометить как решенное">
                                                <i class="fas fa-check"></i>
                                            </button>
                                            <button @click="deleteFeedback(feedback)"
                                                    class="text-gray-500 hover:text-error-600"
                                                    title="Удалить">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <p class="text-gray-700 mb-3" x-text="feedback.message"></p>
                                    
                                    <!-- Ответы на отзыв -->
                                    <div x-show="feedback.replies && feedback.replies.length > 0" 
                                         class="mt-3 pt-3 border-t">
                                        <h6 class="text-sm font-medium mb-2">Ответы:</h6>
                                        <div class="space-y-2">
                                            <template x-for="reply in feedback.replies" :key="reply.id">
                                                <div class="pl-4 border-l-2 border-gray-300">
                                                    <div class="text-sm">
                                                        <span class="font-medium" x-text="reply.author || 'Аноним'"></span>
                                                        <span class="text-gray-500 ml-2" x-text="formatDate(reply.createdAt)"></span>
                                                    </div>
                                                    <p class="text-gray-600" x-text="reply.message"></p>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                    
                                    <!-- Форма ответа -->
                                    <div class="mt-3">
                                        <div class="flex gap-2">
                                            <input type="text" 
                                                   x-model="feedback.replyText"
                                                   @keyup.enter="addReply(feedback)"
                                                   placeholder="Написать ответ..."
                                                   class="flex-1 form-input py-1 text-sm">
                                            <button @click="addReply(feedback)" 
                                                    class="btn btn-outline py-1">
                                                Ответить
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </template>
                            
                            <!-- Пустое состояние -->
                            <div x-show="filteredFeedbacks.length === 0" class="text-center py-8">
                                <i class="fas fa-comments text-3xl text-gray-300 mb-3"></i>
                                <h4 class="h6 mb-2">Нет отзывов</h4>
                                <p class="text-gray-500" x-text="feedbackFilter !== 'all' ? 
                                    'Нет отзывов по выбранному фильтру' : 
                                    'Будьте первым, кто оставит отзыв'"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('alpine:init', () => {
            // Глобальное состояние приложения
            Alpine.store('app', {
                currentView: 'dashboard',
                
                designTokens: {
                    colors: {
                        primary: {
                            '50': '#eef2ff',
                            '100': '#e0e7ff',
                            '200': '#c7d2fe',
                            '300': '#a5b4fc',
                            '400': '#818cf8',
                            '500': '#6366f1',
                            '600': '#4f46e5',
                            '700': '#4338ca',
                            '800': '#3730a3',
                            '900': '#312e81'
                        },
                        gray: {
                            '50': '#f9fafb',
                            '100': '#f3f4f6',
                            '200': '#e5e7eb',
                            '300': '#d1d5db',
                            '400': '#9ca3af',
                            '500': '#6b7280',
                            '600': '#4b5563',
                            '700': '#374151',
                            '800': '#1f2937',
                            '900': '#111827'
                        },
                        semantic: {
                            success: '#10b981',
                            warning: '#f59e0b',
                            error: '#ef4444',
                            info: '#3b82f6'
                        }
                    },
                    typography: {
                        fontFamilies: {
                            sans: "'Inter', system-ui, -apple-system, sans-serif",
                            mono: "'Roboto Mono', 'Courier New', monospace"
                        },
                        fontSizes: {
                            xs: '0.75rem',
                            sm: '0.875rem',
                            base: '1rem',
                            lg: '1.125rem',
                            xl: '1.25rem',
                            '2xl': '1.5rem',
                            '3xl': '1.875rem',
                            '4xl': '2.25rem'
                        },
                        fontWeights: {
                            light: '300',
                            normal: '400',
                            medium: '500',
                            semibold: '600',
                            bold: '700'
                        }
                    }
                },
                
                updateToken(category, key, value) {
                    if (this.designTokens[category] && this.designTokens[category][key]) {
                        this.designTokens[category][key] = value;
                        this.applyTokensToCSS();
                        this.saveToLocalStorage();
                    }
                },
                
                applyTokensToCSS() {
                    const root = document.documentElement;
                    
                    Object.entries(this.designTokens.colors.primary).forEach(([shade, value]) => {
                        root.style.setProperty(`--color-primary-${shade}`, value);
                    });
                    
                    Object.entries(this.designTokens.colors.gray).forEach(([shade, value]) => {
                        root.style.setProperty(`--color-gray-${shade}`, value);
                    });
                    
                    Object.entries(this.designTokens.colors.semantic).forEach(([name, value]) => {
                        root.style.setProperty(`--color-${name}`, value);
                    });
                    
                    Object.entries(this.designTokens.typography.fontSizes).forEach(([name, value]) => {
                        root.style.setProperty(`--font-size-${name}`, value);
                    });
                },
                
                saveToLocalStorage() {
                    localStorage.setItem('uiKitDesignTokens', JSON.stringify(this.designTokens));
                },
                
                loadFromLocalStorage() {
                    const saved = localStorage.getItem('uiKitDesignTokens');
                    if (saved) {
                        this.designTokens = JSON.parse(saved);
                        this.applyTokensToCSS();
                    }
                },
                
                init() {
                    this.loadFromLocalStorage();
                    this.applyTokensToCSS();
                }
            });
            
            // Store для компонентов
            Alpine.store('components', {
                list: [],
                currentComponent: null,
                componentTypes: ['button', 'input', 'card', 'alert', 'badge', 'avatar', 'modal'],
                
                createComponent(type = 'button') {
                    const baseComponents = {
                        button: {
                            id: Date.now(),
                            name: 'Новая кнопка',
                            type: 'button',
                            category: 'basic',
                            version: '1.0.0',
                            createdAt: new Date().toISOString(),
                            updatedAt: new Date().toISOString(),
                            variants: [
                                {
                                    name: 'primary',
                                    properties: {
                                        text: 'Кнопка',
                                        bgColor: 'var(--color-primary-600)',
                                        textColor: 'white',
                                        padding: 'var(--spacing-2) var(--spacing-4)',
                                        borderRadius: 'var(--radius-md)',
                                        fontSize: 'var(--font-size-sm)',
                                        fontWeight: 'var(--font-weight-medium)'
                                    },
                                    html: '<button class="btn btn-primary">Кнопка</button>',
                                    css: `.btn-primary { background: var(--color-primary-600); color: white; }`
                                }
                            ]
                        },
                        card: {
                            id: Date.now() + 1,
                            name: 'Новая карточка',
                            type: 'card',
                            category: 'layout',
                            version: '1.0.0',
                            createdAt: new Date().toISOString(),
                            updatedAt: new Date().toISOString(),
                            variants: [
                                {
                                    name: 'default',
                                    properties: {
                                        bgColor: 'white',
                                        padding: 'var(--spacing-6)',
                                        borderRadius: 'var(--radius-lg)',
                                        shadow: 'var(--shadow-md)'
                                    },
                                    html: '<div class="card">Содержимое карточки</div>',
                                    css: `.card { background: white; border-radius: var(--radius-lg); }`
                                }
                            ]
                        }
                    };
                    
                    const component = baseComponents[type] || {
                        id: Date.now(),
                        name: `Новый ${type}`,
                        type: type,
                        category: 'basic',
                        version: '1.0.0',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString(),
                        variants: []
                    };
                    
                    this.list.push(component);
                    this.currentComponent = component;
                    this.saveToLocalStorage();
                    
                    return component;
                },
                
                updateComponent(id, updates) {
                    const index = this.list.findIndex(c => c.id === id);
                    if (index !== -1) {
                        this.list[index] = { ...this.list[index], ...updates, updatedAt: new Date().toISOString() };
                        if (this.currentComponent && this.currentComponent.id === id) {
                            this.currentComponent = this.list[index];
                        }
                        this.saveToLocalStorage();
                    }
                },
                
                addVariant(componentId, variantName) {
                    const component = this.list.find(c => c.id === componentId);
                    if (component && component.variants.length > 0) {
                        const baseVariant = { ...component.variants[0] };
                        baseVariant.name = variantName;
                        component.variants.push(baseVariant);
                        this.updateComponent(componentId, { variants: component.variants });
                    }
                },
                
                removeVariant(componentId, variantName) {
                    const component = this.list.find(c => c.id === componentId);
                    if (component && component.variants.length > 1) {
                        component.variants = component.variants.filter(v => v.name !== variantName);
                        this.updateComponent(componentId, { variants: component.variants });
                    }
                },
                
                saveToLocalStorage() {
                    localStorage.setItem('uiKitComponents', JSON.stringify(this.list));
                },
                
                loadFromLocalStorage() {
                    const saved = localStorage.getItem('uiKitComponents');
                    if (saved) {
                        this.list = JSON.parse(saved);
                    }
                },
                
                init() {
                    this.loadFromLocalStorage();
                }
            });
            
            // Store для управления версиями
            Alpine.store('versions', {
                releases: [],
                currentVersion: '1.0.0',
                
                createRelease(version, changeType, description) {
                    const components = Alpine.store('components').list.map(component => ({
                        id: component.id,
                        name: component.name,
                        type: component.type,
                        version: component.version,
                        changes: 'Изменения не указаны'
                    }));
                    
                    const release = {
                        id: Date.now(),
                        version: version,
                        changeType: changeType,
                        description: description,
                        components: components,
                        createdAt: new Date().toISOString()
                    };
                    
                    this.releases.unshift(release);
                    this.currentVersion = version;
                    this.saveToLocalStorage();
                    
                    return release;
                },
                
                getComponentHistory(componentId) {
                    const history = [];
                    
                    this.releases.forEach(release => {
                        const componentInRelease = release.components?.find(c => c.id === componentId);
                        if (componentInRelease) {
                            history.push({
                                version: release.version,
                                date: release.createdAt,
                                changes: componentInRelease.changes
                            });
                        }
                    });
                    
                    return history;
                },
                
                saveToLocalStorage() {
                    localStorage.setItem('uiKitVersions', JSON.stringify({
                        releases: this.releases,
                        currentVersion: this.currentVersion
                    }));
                },
                
                loadFromLocalStorage() {
                    const saved = localStorage.getItem('uiKitVersions');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.releases = data.releases || [];
                        this.currentVersion = data.currentVersion || '1.0.0';
                    }
                },
                
                init() {
                    this.loadFromLocalStorage();
                }
            });
            
            // Store для коллаборации
            Alpine.store('collaboration', {
                feedbacks: [],
                
                addFeedback(feedback) {
                    const newFeedback = {
                        id: Date.now(),
                        ...feedback,
                        createdAt: new Date().toISOString(),
                        resolved: false,
                        replies: []
                    };
                    
                    this.feedbacks.unshift(newFeedback);
                    this.saveToLocalStorage();
                    
                    return newFeedback;
                },
                
                addReply(feedbackId, reply) {
                    const feedback = this.feedbacks.find(f => f.id === feedbackId);
                    if (feedback) {
                        if (!feedback.replies) {
                            feedback.replies = [];
                        }
                        
                        feedback.replies.push({
                            id: Date.now(),
                            ...reply,
                            createdAt: new Date().toISOString()
                        });
                        
                        this.saveToLocalStorage();
                    }
                },
                
                resolveFeedback(feedbackId) {
                    const feedback = this.feedbacks.find(f => f.id === feedbackId);
                    if (feedback) {
                        feedback.resolved = true;
                        this.saveToLocalStorage();
                    }
                },
                
                removeFeedback(feedbackId) {
                    this.feedbacks = this.feedbacks.filter(f => f.id !== feedbackId);
                    this.saveToLocalStorage();
                },
                
                saveToLocalStorage() {
                    localStorage.setItem('uiKitFeedback', JSON.stringify(this.feedbacks));
                },
                
                loadFromLocalStorage() {
                    const saved = localStorage.getItem('uiKitFeedback');
                    if (saved) {
                        this.feedbacks = JSON.parse(saved);
                    }
                },
                
                init() {
                    this.loadFromLocalStorage();
                }
            });
            
            // Инициализация всех stores
            Alpine.store('app').init();
            Alpine.store('components').init();
            Alpine.store('versions').init();
            Alpine.store('collaboration').init();
        });
        
        // Компонент для редактора
        document.addEventListener('alpine:init', () => {
            Alpine.data('editor', () => ({
                newComponentType: '',
                newComponentName: '',
                newComponentCategory: 'basic',
                editorTab: 'preview',
                
                createNewComponent() {
                    if (!this.newComponentType) return;
                    
                    const component = Alpine.store('components').createComponent(this.newComponentType);
                    
                    if (this.newComponentName) {
                        Alpine.store('components').updateComponent(component.id, { 
                            name: this.newComponentName,
                            category: this.newComponentCategory
                        });
                    }
                    
                    this.newComponentType = '';
                    this.newComponentName = '';
                    this.newComponentCategory = 'basic';
                    this.editorTab = 'properties';
                },
                
                saveComponent() {
                    const component = Alpine.store('components').currentComponent;
                    if (component) {
                        Alpine.store('components').updateComponent(component.id, {
                            updatedAt: new Date().toISOString()
                        });
                        this.showNotification('Компонент сохранен', 'success');
                    }
                },
                
                addVariant() {
                    const component = Alpine.store('components').currentComponent;
                    if (component) {
                        const variantName = prompt('Введите название варианта:');
                        if (variantName) {
                            Alpine.store('components').addVariant(component.id, variantName);
                            this.showNotification('Вариант добавлен', 'success');
                        }
                    }
                },
                
                removeVariant(index) {
                    const component = Alpine.store('components').currentComponent;
                    if (component && component.variants[index]) {
                        if (confirm(`Удалить вариант "${component.variants[index].name}"?`)) {
                            Alpine.store('components').removeVariant(component.id, component.variants[index].name);
                            this.showNotification('Вариант удален', 'warning');
                        }
                    }
                },
                
                editVariant(index) {
                    const component = Alpine.store('components').currentComponent;
                    if (component && component.variants[index]) {
                        const newName = prompt('Введите новое название варианта:', component.variants[index].name);
                        if (newName) {
                            component.variants[index].name = newName;
                            Alpine.store('components').updateComponent(component.id, {
                                variants: component.variants
                            });
                        }
                    }
                },
                
                exportComponent(component) {
                    const exportData = {
                        name: component.name,
                        type: component.type,
                        version: component.version,
                        variants: component.variants
                    };
                    
                    const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${component.name.toLowerCase().replace(/\s+/g, '-')}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    this.showNotification('Компонент экспортирован', 'success');
                },
                
                showNotification(message, type = 'info') {
                    const notification = document.createElement('div');
                    notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg text-white z-50 ${
                        type === 'success' ? 'bg-green-500' :
                        type === 'error' ? 'bg-red-500' :
                        type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
                    }`;
                    notification.innerHTML = `
                        <div class="flex items-center gap-2">
                            <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}"></i>
                            <span>${message}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.transition = 'opacity 0.3s';
                        notification.style.opacity = '0';
                        setTimeout(() => notification.remove(), 300);
                    }, 3000);
                }
            }));
            
            // Компонент для библиотеки
            Alpine.data('library', () => ({
                searchQuery: '',
                filterType: '',
                filterCategory: '',
                sortBy: 'name',
                currentPage: 1,
                itemsPerPage: 9,
                
                get filteredComponents() {
                    let components = [...Alpine.store('components').list];
                    
                    if (this.searchQuery) {
                        const query = this.searchQuery.toLowerCase();
                        components = components.filter(c => 
                            c.name.toLowerCase().includes(query) || 
                            c.type.toLowerCase().includes(query) ||
                            c.category.toLowerCase().includes(query)
                        );
                    }
                    
                    if (this.filterType) {
                        components = components.filter(c => c.type === this.filterType);
                    }
                    
                    if (this.filterCategory) {
                        components = components.filter(c => c.category === this.filterCategory);
                    }
                    
                    components.sort((a, b) => {
                        if (this.sortBy === 'name') {
                            return a.name.localeCompare(b.name);
                        } else if (this.sortBy === 'createdAt') {
                            return new Date(b.createdAt) - new Date(a.createdAt);
                        } else if (this.sortBy === 'updatedAt') {
                            return new Date(b.updatedAt) - new Date(a.updatedAt);
                        } else if (this.sortBy === 'type') {
                            return a.type.localeCompare(b.type);
                        }
                        return 0;
                    });
                    
                    const start = (this.currentPage - 1) * this.itemsPerPage;
                    const end = start + this.itemsPerPage;
                    
                    return components.slice(start, end);
                },
                
                getCategoryName(category) {
                    const categories = {
                        'basic': 'Базовые',
                        'forms': 'Формы',
                        'layout': 'Макет',
                        'feedback': 'Обратная связь',
                        'navigation': 'Навигация'
                    };
                    return categories[category] || category;
                },
                
                formatDate(dateString) {
                    const date = new Date(dateString);
                    return date.toLocaleDateString('ru-RU', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric'
                    });
                },
                
                editComponent(component) {
                    Alpine.store('components').currentComponent = component;
                    Alpine.store('app').currentView = 'editor';
                },
                
                exportComponent(component) {
                    this.$root.querySelector('[x-data="editor"]')?.__x.$data.exportComponent(component);
                },
                
                deleteComponent(component) {
                    if (confirm(`Удалить компонент "${component.name}"?`)) {
                        const store = Alpine.store('components');
                        store.list = store.list.filter(c => c.id !== component.id);
                        
                        if (store.currentComponent?.id === component.id) {
                            store.currentComponent = null;
                        }
                        
                        store.saveToLocalStorage();
                        this.showNotification('Компонент удален', 'warning');
                    }
                },
                
                exportLibrary() {
                    const libraryData = {
                        metadata: {
                            exportedAt: new Date().toISOString(),
                            version: '1.0',
                            componentCount: Alpine.store('components').list.length
                        },
                        designTokens: Alpine.store('app').designTokens,
                        components: Alpine.store('components').list
                    };
                    
                    const blob = new Blob([JSON.stringify(libraryData, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `ui-kit-library-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    this.showNotification('Библиотека экспортирована', 'success');
                },
                
                showNotification(message, type = 'info') {
                    const notification = document.createElement('div');
                    notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg text-white z-50 ${
                        type === 'success' ? 'bg-green-500' :
                        type === 'error' ? 'bg-red-500' :
                        type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
                    }`;
                    notification.innerHTML = `
                        <div class="flex items-center gap-2">
                            <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}"></i>
                            <span>${message}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.transition = 'opacity 0.3s';
                        notification.style.opacity = '0';
                        setTimeout(() => notification.remove(), 300);
                    }, 3000);
                }
            }));
            
            // Компонент для управления версиями
            Alpine.data('versions', () => ({
                newVersion: {
                    major: 1,
                    minor: 0,
                    patch: 0,
                    changeType: 'minor',
                    description: ''
                },
                selectedReleaseId: null,
                
                get releases() {
                    return Alpine.store('versions').releases;
                },
                
                getCurrentVersion() {
                    return Alpine.store('versions').currentVersion;
                },
                
                isValidVersion() {
                    return this.newVersion.description.trim() !== '';
                },
                
                getChangedComponentsCount() {
                    const changes = new Set();
                    this.releases.forEach(release => {
                        release.components?.forEach(component => {
                            changes.add(component.id);
                        });
                    });
                    return changes.size;
                },
                
                getChangeTypeName(type) {
                    const names = {
                        'major': 'Критическое',
                        'minor': 'Новая функция',
                        'patch': 'Исправление'
                    };
                    return names[type] || type;
                },
                
                formatDate(dateString) {
                    const date = new Date(dateString);
                    return date.toLocaleDateString('ru-RU', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                },
                
                createRelease() {
                    const version = `${this.newVersion.major}.${this.newVersion.minor}.${this.newVersion.patch}`;
                    
                    const release = Alpine.store('versions').createRelease(
                        version,
                        this.newVersion.changeType,
                        this.newVersion.description
                    );
                    
                    this.newVersion = {
                        major: parseInt(version.split('.')[0]),
                        minor: parseInt(version.split('.')[1]),
                        patch: parseInt(version.split('.')[2]) + 1,
                        changeType: 'patch',
                        description: ''
                    };
                    
                    this.showNotification(`Релиз ${version} создан`, 'success');
                },
                
                viewReleaseDetails(release) {
                    this.selectedReleaseId = this.selectedReleaseId === release.id ? null : release.id;
                },
                
                exportRelease(release) {
                    const exportData = {
                        release: release,
                        designTokens: Alpine.store('app').designTokens
                    };
                    
                    const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `release-${release.version}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    this.showNotification(`Релиз ${release.version} экспортирован`, 'success');
                },
                
                exportVersionHistory() {
                    const historyData = {
                        metadata: {
                            exportedAt: new Date().toISOString(),
                            currentVersion: Alpine.store('versions').currentVersion,
                            releaseCount: this.releases.length
                        },
                        releases: this.releases
                    };
                    
                    const blob = new Blob([JSON.stringify(historyData, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `version-history-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    this.showNotification('История версий экспортирована', 'success');
                },
                
                showNotification(message, type = 'info') {
                    const notification = document.createElement('div');
                    notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg text-white z-50 ${
                        type === 'success' ? 'bg-green-500' :
                        type === 'error' ? 'bg-red-500' :
                        type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
                    }`;
                    notification.innerHTML = `
                        <div class="flex items-center gap-2">
                            <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}"></i>
                            <span>${message}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.transition = 'opacity 0.3s';
                        notification.style.opacity = '0';
                        setTimeout(() => notification.remove(), 300);
                    }, 3000);
                }
            }));
            
            // Компонент для коллаборации
            Alpine.data('collaboration', () => ({
                newFeedback: {
                    componentId: '',
                    type: 'comment',
                    message: '',
                    priority: 'medium',
                    author: 'Пользователь'
                },
                feedbackFilter: 'all',
                
                get feedbacks() {
                    return Alpine.store('collaboration').feedbacks;
                },
                
                get filteredFeedbacks() {
                    let filtered = [...this.feedbacks];
                    
                    if (this.feedbackFilter === 'open') {
                        filtered = filtered.filter(f => !f.resolved);
                    } else if (this.feedbackFilter === 'resolved') {
                        filtered = filtered.filter(f => f.resolved);
                    } else if (this.feedbackFilter === 'issues') {
                        filtered = filtered.filter(f => f.type === 'issue');
                    } else if (this.feedbackFilter === 'suggestions') {
                        filtered = filtered.filter(f => f.type === 'suggestion');
                    }
                    
                    return filtered;
                },
                
                getComponentName(componentId) {
                    const component = Alpine.store('components').list.find(c => c.id === componentId);
                    return component ? component.name : 'Общий отзыв';
                },
                
                getFeedbackTypeName(type) {
                    const names = {
                        'comment': 'Комментарий',
                        'suggestion': 'Предложение',
                        'issue': 'Проблема',
                        'praise': 'Похвала'
                    };
                    return names[type] || type;
                },
                
                getPriorityName(priority) {
                    const names = {
                        'low': 'Низкий',
                        'medium': 'Средний',
                        'high': 'Высокий'
                    };
                    return names[priority] || priority;
                },
                
                getOpenIssuesCount() {
                    return this.feedbacks.filter(f => f.type === 'issue' && !f.resolved).length;
                },
                
                getResolvedCount() {
                    return this.feedbacks.filter(f => f.resolved).length;
                },
                
                formatDate(dateString) {
                    const date = new Date(dateString);
                    return date.toLocaleDateString('ru-RU', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                },
                
                isValidFeedback() {
                    return this.newFeedback.message.trim() !== '';
                },
                
                submitFeedback() {
                    if (!this.isValidFeedback()) return;
                    
                    const feedback = Alpine.store('collaboration').addFeedback(this.newFeedback);
                    
                    this.newFeedback = {
                        componentId: '',
                        type: 'comment',
                        message: '',
                        priority: 'medium',
                        author: 'Пользователь'
                    };
                    
                    this.showNotification('Отзыв отправлен', 'success');
                },
                
                addReply(feedback) {
                    if (!feedback.replyText || feedback.replyText.trim() === '') return;
                    
                    Alpine.store('collaboration').addReply(feedback.id, {
                        message: feedback.replyText,
                        author: 'Пользователь'
                    });
                    
                    feedback.replyText = '';
                    this.showNotification('Ответ добавлен', 'success');
                },
                
                resolveFeedback(feedback) {
                    Alpine.store('collaboration').resolveFeedback(feedback.id);
                    this.showNotification('Отзыв помечен как решенный', 'success');
                },
                
                deleteFeedback(feedback) {
                    if (confirm('Удалить этот отзыв?')) {
                        Alpine.store('collaboration').removeFeedback(feedback.id);
                        this.showNotification('Отзыв удален', 'warning');
                    }
                },
                
                showNotification(message, type = 'info') {
                    const notification = document.createElement('div');
                    notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg text-white z-50 ${
                        type === 'success' ? 'bg-green-500' :
                        type === 'error' ? 'bg-red-500' :
                        type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
                    }`;
                    notification.innerHTML = `
                        <div class="flex items-center gap-2">
                            <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}"></i>
                            <span>${message}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.transition = 'opacity 0.3s';
                        notification.style.opacity = '0';
                        setTimeout(() => notification.remove(), 300);
                    }, 3000);
                }
            }));
            
            // Глобальные функции приложения
            Alpine.data('app', () => ({
                exportFullSystem() {
                    const systemData = {
                        metadata: {
                            exportedAt: new Date().toISOString(),
                            version: '1.0.0',
                            system: 'UI Kit Constructor'
                        },
                        designTokens: Alpine.store('app').designTokens,
                        components: Alpine.store('components').list,
                        versions: Alpine.store('versions'),
                        feedback: Alpine.store('collaboration').feedbacks
                    };
                    
                    const blob = new Blob([JSON.stringify(systemData, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `ui-kit-system-backup-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    this.showNotification('Полная система экспортирована', 'success');
                },
                
                importSystem(event) {
                    const file = event.target.files[0];
                    if (!file) return;
                    
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            
                            if (data.designTokens) {
                                Alpine.store('app').designTokens = data.designTokens;
                                Alpine.store('app').applyTokensToCSS();
                            }
                            
                            if (data.components) {
                                Alpine.store('components').list = data.components;
                                Alpine.store('components').saveToLocalStorage();
                            }
                            
                            if (data.versions) {
                                Alpine.store('versions').releases = data.versions.releases || [];
                                Alpine.store('versions').currentVersion = data.versions.currentVersion || '1.0.0';
                                Alpine.store('versions').saveToLocalStorage();
                            }
                            
                            if (data.feedback) {
                                Alpine.store('collaboration').feedbacks = data.feedback;
                                Alpine.store('collaboration').saveToLocalStorage();
                            }
                            
                            this.showNotification('Система успешно импортирована', 'success');
                            
                            setTimeout(() => location.reload(), 1000);
                            
                        } catch (error) {
                            this.showNotification('Ошибка импорта: неверный формат файла', 'error');
                        }
                    };
                    reader.readAsText(file);
                },
                
                clearAllData() {
                    if (confirm('ВНИМАНИЕ: Это удалит все данные системы. Продолжить?')) {
                        localStorage.clear();
                        location.reload();
                    }
                },
                
                generateCSSFile() {
                    const tokens = Alpine.store('app').designTokens;
                    let css = `/* UI Kit CSS - Generated ${new Date().toLocaleDateString()} */\n\n`;
                    
                    css += ':root {\n';
                    
                    Object.entries(tokens.colors.primary).forEach(([shade, value]) => {
                        css += `  --color-primary-${shade}: ${value};\n`;
                    });
                    
                    Object.entries(tokens.colors.gray).forEach(([shade, value]) => {
                        css += `  --color-gray-${shade}: ${value};\n`;
                    });
                    
                    Object.entries(tokens.colors.semantic).forEach(([name, value]) => {
                        css += `  --color-${name}: ${value};\n`;
                    });
                    
                    Object.entries(tokens.typography.fontSizes).forEach(([name, value]) => {
                        css += `  --font-size-${name}: ${value};\n`;
                    });
                    
                    css += '}\n\n';
                    
                    css += '/* Компоненты */\n\n';
                    
                    Alpine.store('components').list.forEach(component => {
                        css += `/* ${component.name} */\n`;
                        component.variants.forEach(variant => {
                            if (variant.css) {
                                css += variant.css + '\n\n';
                            }
                        });
                    });
                    
                    const blob = new Blob([css], { type: 'text/css' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'ui-kit-styles.css';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    this.showNotification('CSS файл сгенерирован', 'success');
                },
                
                showNotification(message, type = 'info') {
                    const notification = document.createElement('div');
                    notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg text-white z-50 ${
                        type === 'success' ? 'bg-green-500' :
                        type === 'error' ? 'bg-red-500' :
                        type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
                    }`;
                    notification.innerHTML = `
                        <div class="flex items-center gap-2">
                            <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation' : 'info'}"></i>
                            <span>${message}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.transition = 'opacity 0.3s';
                        notification.style.opacity = '0';
                        setTimeout(() => notification.remove(), 300);
                    }, 3000);
                }
            }));
        });
    </script>
</body>
</html>
